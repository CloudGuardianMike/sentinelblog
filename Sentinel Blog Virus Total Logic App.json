{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "workflows_blogVirusTotalLookup_name": {
            "defaultValue": "blogVirusTotalLookup",
            "type": "String"
        },
        "subId": {
            "type": "String"
        },
        "resourceGroupName": {
            "type": "String"
        }
    },
    "variables": {
        "connections_azuresentinel_blogVirusTotalLookup_externalid": "[concat('/subscriptions/', parameters('subId'),'/resourceGroups/',parameters('resourceGroupName'),'/providers/Microsoft.Web/connections/azuresentinel-blogVirusTotalLookup')]"
    },
    "resources": [
        {
            "type": "Microsoft.Logic/workflows",
            "apiVersion": "2017-07-01",
            "name": "[parameters('workflows_blogVirusTotalLookup_name')]",
            "location": "uksouth",
            "identity": {
                "type": "SystemAssigned"
            },
            "properties": {
                "state": "Enabled",
                "definition": {
                    "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                        "$connections": {
                            "defaultValue": {},
                            "type": "Object"
                        }
                    },
                    "triggers": {
                        "Microsoft_Sentinel_incident": {
                            "type": "ApiConnectionWebhook",
                            "inputs": {
                                "body": {
                                    "callback_url": "@{listCallbackUrl()}"
                                },
                                "host": {
                                    "connection": {
                                        "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                    }
                                },
                                "path": "/incident-creation"
                            }
                        }
                    },
                    "actions": {
                        "Entities_-_Get_FileHashes": {
                            "runAfter": {
                                "IP_Last_Analysis_Results": [
                                    "Succeeded"
                                ]
                            },
                            "type": "ApiConnection",
                            "inputs": {
                                "body": "@triggerBody()?['object']?['properties']?['relatedEntities']",
                                "host": {
                                    "connection": {
                                        "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                    }
                                },
                                "method": "post",
                                "path": "/entities/filehash"
                            }
                        },
                        "Entities_-_Get_IPs": {
                            "runAfter": {
                                "IP_Last_Analysis_Results": [
                                    "Succeeded"
                                ]
                            },
                            "type": "ApiConnection",
                            "inputs": {
                                "body": "@triggerBody()?['object']?['properties']?['relatedEntities']",
                                "host": {
                                    "connection": {
                                        "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                    }
                                },
                                "method": "post",
                                "path": "/entities/ip"
                            }
                        },
                        "FileHash_Last_Analysis_Report": {
                            "runAfter": {
                                "FileHash_Sandbox_Results": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "FileHash Analysis Report",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "FileHash_Sandbox_Results": {
                            "runAfter": {
                                "File_Hash_Threat_Classification": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "FileHashSandboxResults",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "File_Hash_Summary_Table": {
                            "runAfter": {
                                "QuotaCounter": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "FileHashStatsTable",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "File_Hash_Threat_Classification": {
                            "runAfter": {
                                "File_Hash_Summary_Table": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "FileHashThreatClassification",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "For_each": {
                            "foreach": "@body('Entities_-_Get_FileHashes')?['Filehashes']",
                            "actions": {
                                "Add_comment_to_incident_(V3)": {
                                    "runAfter": {
                                        "FileHash_Analysis_Report": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "ApiConnection",
                                    "inputs": {
                                        "body": {
                                            "incidentArmId": "@triggerBody()?['object']?['id']",
                                            "message": "<p><span style=\"font-size: 18px\"><strong>Analysis of </strong></span><span style=\"font-size: 18px\"><strong>@{items('For_each')?['Value']}</strong></span><span style=\"font-size: 18px\"><strong> from Virus Total</strong></span><span style=\"font-size: 24px\"><br>\n</span><span style=\"font-size: 12px\">Summary: </span><span style=\"font-size: 12px\">@{body('FileHash_Stats_Summary')}</span><span style=\"font-size: 12px\"><br>\nThreat Classification: </span><span style=\"font-size: 12px\">@{body('FileHash_Threat_Classification_Report')}</span><span style=\"font-size: 12px\"><br>\nYara Matches: </span><span style=\"font-size: 12px\">@{body('FileHash_Yara_Report')}</span><span style=\"font-size: 12px\"><br>\nSandbox Results: </span><span style=\"font-size: 12px\">@{body('FileHash_Sandbox_Report')}</span><span style=\"font-size: 12px\"><br>\nFull Report: </span><span style=\"font-size: 12px\">@{concat('https://www.virustotal.com/gui/file/',items('For_each')?['Value'])}</span><span style=\"font-size: 12px\"><br>\n</span></p>"
                                        },
                                        "host": {
                                            "connection": {
                                                "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                            }
                                        },
                                        "method": "post",
                                        "path": "/Incidents/Comment"
                                    }
                                },
                                "Condition": {
                                    "actions": {
                                        "Delay": {
                                            "runAfter": {},
                                            "type": "Wait",
                                            "inputs": {
                                                "interval": {
                                                    "count": 1,
                                                    "unit": "Minute"
                                                }
                                            }
                                        },
                                        "Set_variable": {
                                            "runAfter": {
                                                "Delay": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "SetVariable",
                                            "inputs": {
                                                "name": "quotaCount",
                                                "value": 0
                                            }
                                        }
                                    },
                                    "runAfter": {},
                                    "expression": {
                                        "and": [
                                            {
                                                "equals": [
                                                    "@variables('quotaCount')",
                                                    4
                                                ]
                                            }
                                        ]
                                    },
                                    "type": "If"
                                },
                                "FileHash_Analysis_Report": {
                                    "runAfter": {
                                        "FileHash_Sandbox_Report": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "Table",
                                    "inputs": {
                                        "format": "HTML",
                                        "from": "@variables('FileHash Analysis Report')"
                                    }
                                },
                                "FileHash_Sandbox_Report": {
                                    "runAfter": {
                                        "FileHash_Yara_Report": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "Table",
                                    "inputs": {
                                        "format": "HTML",
                                        "from": "@variables('FileHashSandboxResults')"
                                    }
                                },
                                "FileHash_Stats_Summary": {
                                    "runAfter": {
                                        "Scope_2": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "Table",
                                    "inputs": {
                                        "format": "HTML",
                                        "from": "@variables('FileHashStatsTable')"
                                    }
                                },
                                "FileHash_Threat_Classification_Report": {
                                    "runAfter": {
                                        "FileHash_Stats_Summary": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "Table",
                                    "inputs": {
                                        "format": "HTML",
                                        "from": "@variables('FileHashThreatClassification')"
                                    }
                                },
                                "FileHash_Yara_Report": {
                                    "runAfter": {
                                        "FileHash_Threat_Classification_Report": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "Table",
                                    "inputs": {
                                        "format": "HTML",
                                        "from": "@body('FileHash_Report')?['data']?['attributes']?['crowdsourced_yara_results']"
                                    }
                                },
                                "Scope_2": {
                                    "actions": {
                                        "FileHash_Report": {
                                            "runAfter": {
                                                "File_Hash_Report": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "ParseJson",
                                            "inputs": {
                                                "content": "@body('File_Hash_Report')",
                                                "schema": {
                                                    "properties": {
                                                        "data": {
                                                            "properties": {
                                                                "attributes": {
                                                                    "properties": {
                                                                        "authentihash": {
                                                                            "type": "string"
                                                                        },
                                                                        "creation_date": {
                                                                            "type": "integer"
                                                                        },
                                                                        "crowdsourced_yara_results": {
                                                                            "items": {
                                                                                "properties": {
                                                                                    "author": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "description": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "match_in_subfile": {
                                                                                        "type": "boolean"
                                                                                    },
                                                                                    "rule_name": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "ruleset_id": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "ruleset_name": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "source": {
                                                                                        "type": "string"
                                                                                    }
                                                                                },
                                                                                "type": "object"
                                                                            },
                                                                            "type": "array"
                                                                        },
                                                                        "detectiteasy": {
                                                                            "properties": {
                                                                                "filetype": {
                                                                                    "type": "string"
                                                                                },
                                                                                "values": {
                                                                                    "items": {
                                                                                        "properties": {
                                                                                            "info": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "name": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "type": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "version": {
                                                                                                "type": "string"
                                                                                            }
                                                                                        },
                                                                                        "type": "object"
                                                                                    },
                                                                                    "type": "array"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "first_seen_itw_date": {
                                                                            "type": "integer"
                                                                        },
                                                                        "first_submission_date": {
                                                                            "type": "integer"
                                                                        },
                                                                        "last_analysis_date": {
                                                                            "type": "integer"
                                                                        },
                                                                        "last_analysis_results": {
                                                                            "properties": {
                                                                                "ALYac": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "APEX": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "AVG": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Acronis": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {}
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "AhnLab-V3": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Alibaba": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Antiy-AVL": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Arcabit": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Avast": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Avast-Mobile": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {}
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Avira": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Baidu": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {}
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "BitDefender": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "BitDefenderFalx": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {}
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "BitDefenderTheta": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Bkav": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {}
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "CAT-QuickHeal": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "CMC": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {}
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "ClamAV": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "CrowdStrike": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Cybereason": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {}
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Cylance": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Cynet": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Cyren": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {}
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "DeepInstinct": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "DrWeb": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "ESET-NOD32": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Elastic": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Emsisoft": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "F-Secure": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "FireEye": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Fortinet": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "GData": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Google": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Gridinsoft": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Ikarus": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Jiangmin": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "K7AntiVirus": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "K7GW": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Kaspersky": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Lionic": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "MAX": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Malwarebytes": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "MaxSecure": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "McAfee": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "McAfee-GW-Edition": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "MicroWorld-eScan": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Microsoft": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "NANO-Antivirus": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Paloalto": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {}
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Panda": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Rising": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "SUPERAntiSpyware": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {}
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Sangfor": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "SentinelOne": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {}
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Sophos": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Symantec": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "SymantecMobileInsight": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {}
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "TACHYON": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {}
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Tencent": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {}
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Trapmine": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {}
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "TrendMicro": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "TrendMicro-HouseCall": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Trustlook": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {}
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "VBA32": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "VIPRE": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "ViRobot": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "VirIT": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {}
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Webroot": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Xcitium": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Yandex": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {}
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Zillya": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "ZoneAlarm": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Zoner": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {}
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "tehtris": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_update": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_version": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": [
                                                                                                "string",
                                                                                                "null"
                                                                                            ]
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "last_analysis_stats": {
                                                                            "properties": {
                                                                                "confirmed-timeout": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "failure": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "harmless": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "malicious": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "suspicious": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "timeout": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "type-unsupported": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "undetected": {
                                                                                    "type": "integer"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "last_modification_date": {
                                                                            "type": "integer"
                                                                        },
                                                                        "last_submission_date": {
                                                                            "type": "integer"
                                                                        },
                                                                        "magic": {
                                                                            "type": "string"
                                                                        },
                                                                        "md5": {
                                                                            "type": "string"
                                                                        },
                                                                        "meaningful_name": {
                                                                            "type": "string"
                                                                        },
                                                                        "names": {
                                                                            "items": {
                                                                                "type": "string"
                                                                            },
                                                                            "type": "array"
                                                                        },
                                                                        "pe_info": {
                                                                            "properties": {
                                                                                "compiler_product_versions": {
                                                                                    "items": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "type": "array"
                                                                                },
                                                                                "entry_point": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "imphash": {
                                                                                    "type": "string"
                                                                                },
                                                                                "import_list": {
                                                                                    "items": {
                                                                                        "properties": {
                                                                                            "imported_functions": {
                                                                                                "items": {
                                                                                                    "type": "string"
                                                                                                },
                                                                                                "type": "array"
                                                                                            },
                                                                                            "library_name": {
                                                                                                "type": "string"
                                                                                            }
                                                                                        },
                                                                                        "type": "object"
                                                                                    },
                                                                                    "type": "array"
                                                                                },
                                                                                "machine_type": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "overlay": {
                                                                                    "properties": {
                                                                                        "chi2": {
                                                                                            "type": "number"
                                                                                        },
                                                                                        "entropy": {
                                                                                            "type": "number"
                                                                                        },
                                                                                        "filetype": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "md5": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "offset": {
                                                                                            "type": "integer"
                                                                                        },
                                                                                        "size": {
                                                                                            "type": "integer"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "resource_details": {
                                                                                    "items": {
                                                                                        "properties": {
                                                                                            "chi2": {
                                                                                                "type": "number"
                                                                                            },
                                                                                            "entropy": {
                                                                                                "type": "number"
                                                                                            },
                                                                                            "filetype": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "lang": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "sha256": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "type": {
                                                                                                "type": "string"
                                                                                            }
                                                                                        },
                                                                                        "type": "object"
                                                                                    },
                                                                                    "type": "array"
                                                                                },
                                                                                "resource_langs": {
                                                                                    "properties": {
                                                                                        "ENGLISH US": {
                                                                                            "type": "integer"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "resource_types": {
                                                                                    "properties": {
                                                                                        "RT_MANIFEST": {
                                                                                            "type": "integer"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "rich_pe_header_hash": {
                                                                                    "type": "string"
                                                                                },
                                                                                "sections": {
                                                                                    "items": {
                                                                                        "properties": {
                                                                                            "chi2": {
                                                                                                "type": "number"
                                                                                            },
                                                                                            "entropy": {
                                                                                                "type": "number"
                                                                                            },
                                                                                            "flags": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "md5": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "name": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "raw_size": {
                                                                                                "type": "integer"
                                                                                            },
                                                                                            "virtual_address": {
                                                                                                "type": "integer"
                                                                                            },
                                                                                            "virtual_size": {
                                                                                                "type": "integer"
                                                                                            }
                                                                                        },
                                                                                        "type": "object"
                                                                                    },
                                                                                    "type": "array"
                                                                                },
                                                                                "timestamp": {
                                                                                    "type": "integer"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "popular_threat_classification": {
                                                                            "properties": {
                                                                                "popular_threat_category": {
                                                                                    "items": {
                                                                                        "properties": {
                                                                                            "count": {
                                                                                                "type": "integer"
                                                                                            },
                                                                                            "value": {
                                                                                                "type": "string"
                                                                                            }
                                                                                        },
                                                                                        "type": "object"
                                                                                    },
                                                                                    "type": "array"
                                                                                },
                                                                                "popular_threat_name": {
                                                                                    "items": {
                                                                                        "properties": {
                                                                                            "count": {
                                                                                                "type": "integer"
                                                                                            },
                                                                                            "value": {
                                                                                                "type": "string"
                                                                                            }
                                                                                        },
                                                                                        "type": "object"
                                                                                    },
                                                                                    "type": "array"
                                                                                },
                                                                                "suggested_threat_label": {
                                                                                    "type": "string"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "reputation": {
                                                                            "type": "integer"
                                                                        },
                                                                        "sandbox_verdicts": {
                                                                            "properties": {
                                                                                "DAS-Security Orcas": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "malware_classification": {
                                                                                            "items": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "type": "array"
                                                                                        },
                                                                                        "sandbox_name": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Zenbox": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "confidence": {
                                                                                            "type": "integer"
                                                                                        },
                                                                                        "malware_classification": {
                                                                                            "items": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "type": "array"
                                                                                        },
                                                                                        "sandbox_name": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "sha1": {
                                                                            "type": "string"
                                                                        },
                                                                        "sha256": {
                                                                            "type": "string"
                                                                        },
                                                                        "signature_info": {
                                                                            "properties": {
                                                                                "counter signers": {
                                                                                    "type": "string"
                                                                                },
                                                                                "counter signers details": {
                                                                                    "items": {
                                                                                        "properties": {
                                                                                            "algorithm": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "cert issuer": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "name": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "serial number": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "status": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "thumbprint": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "valid from": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "valid to": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "valid usage": {
                                                                                                "type": "string"
                                                                                            }
                                                                                        },
                                                                                        "type": "object"
                                                                                    },
                                                                                    "type": "array"
                                                                                },
                                                                                "signers": {
                                                                                    "type": "string"
                                                                                },
                                                                                "signers details": {
                                                                                    "items": {
                                                                                        "properties": {
                                                                                            "algorithm": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "cert issuer": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "name": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "serial number": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "status": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "thumbprint": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "valid from": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "valid to": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "valid usage": {
                                                                                                "type": "string"
                                                                                            }
                                                                                        },
                                                                                        "type": "object"
                                                                                    },
                                                                                    "type": "array"
                                                                                },
                                                                                "signing date": {
                                                                                    "type": "string"
                                                                                },
                                                                                "verified": {
                                                                                    "type": "string"
                                                                                },
                                                                                "x509": {
                                                                                    "items": {
                                                                                        "properties": {
                                                                                            "algorithm": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "cert issuer": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "name": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "serial number": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "thumbprint": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "valid from": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "valid to": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "valid_usage": {
                                                                                                "type": "string"
                                                                                            }
                                                                                        },
                                                                                        "type": "object"
                                                                                    },
                                                                                    "type": "array"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "size": {
                                                                            "type": "integer"
                                                                        },
                                                                        "ssdeep": {
                                                                            "type": "string"
                                                                        },
                                                                        "tags": {
                                                                            "items": {
                                                                                "type": "string"
                                                                            },
                                                                            "type": "array"
                                                                        },
                                                                        "times_submitted": {
                                                                            "type": "integer"
                                                                        },
                                                                        "tlsh": {
                                                                            "type": "string"
                                                                        },
                                                                        "total_votes": {
                                                                            "properties": {
                                                                                "harmless": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "malicious": {
                                                                                    "type": "integer"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "trid": {
                                                                            "items": {
                                                                                "properties": {
                                                                                    "file_type": {
                                                                                        "type": "string"
                                                                                    },
                                                                                    "probability": {
                                                                                        "type": "number"
                                                                                    }
                                                                                },
                                                                                "type": "object"
                                                                            },
                                                                            "type": "array"
                                                                        },
                                                                        "type_description": {
                                                                            "type": "string"
                                                                        },
                                                                        "type_extension": {
                                                                            "type": "string"
                                                                        },
                                                                        "type_tag": {
                                                                            "type": "string"
                                                                        },
                                                                        "type_tags": {
                                                                            "items": {
                                                                                "type": "string"
                                                                            },
                                                                            "type": "array"
                                                                        },
                                                                        "unique_sources": {
                                                                            "type": "integer"
                                                                        },
                                                                        "vhash": {
                                                                            "type": "string"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                },
                                                                "id": {
                                                                    "type": "string"
                                                                },
                                                                "links": {
                                                                    "properties": {
                                                                        "self": {
                                                                            "type": "string"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                },
                                                                "type": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "type": "object"
                                                        }
                                                    },
                                                    "type": "object"
                                                }
                                            }
                                        },
                                        "File_Hash_Report": {
                                            "runAfter": {
                                                "Increment_variable": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Http",
                                            "inputs": {
                                                "headers": {
                                                    "x-apikey": "@variables('VT_API_Key')"
                                                },
                                                "method": "GET",
                                                "uri": "\nhttps://www.virustotal.com/api/v3/files/@{items('For_each')?['Value']}"
                                            }
                                        },
                                        "Increment_variable": {
                                            "runAfter": {},
                                            "type": "IncrementVariable",
                                            "inputs": {
                                                "name": "quotaCount",
                                                "value": 1
                                            }
                                        },
                                        "Last_Analysis_Report": {
                                            "runAfter": {
                                                "Sandbox_Results": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "AppendToArrayVariable",
                                            "inputs": {
                                                "name": "FileHash Analysis Report",
                                                "value": "@body('FileHash_Report')?['data']?['attributes']?['last_analysis_results']"
                                            }
                                        },
                                        "Last_Analysis_Summary": {
                                            "runAfter": {
                                                "FileHash_Report": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "AppendToArrayVariable",
                                            "inputs": {
                                                "name": "FileHashStatsTable",
                                                "value": "@body('FileHash_Report')?['data']?['attributes']?['last_analysis_stats']"
                                            }
                                        },
                                        "Sandbox_Results": {
                                            "runAfter": {
                                                "Threat_Classification": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "AppendToArrayVariable",
                                            "inputs": {
                                                "name": "FileHashSandboxResults",
                                                "value": "@body('FileHash_Report')?['data']?['attributes']?['sandbox_verdicts']"
                                            }
                                        },
                                        "Threat_Classification": {
                                            "runAfter": {
                                                "Last_Analysis_Summary": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "AppendToArrayVariable",
                                            "inputs": {
                                                "name": "FileHashThreatClassification",
                                                "value": "@body('FileHash_Report')?['data']?['attributes']?['popular_threat_classification']"
                                            }
                                        }
                                    },
                                    "runAfter": {
                                        "Condition": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "Scope"
                                }
                            },
                            "runAfter": {
                                "Entities_-_Get_FileHashes": [
                                    "Succeeded"
                                ]
                            },
                            "type": "Foreach"
                        },
                        "For_each_2": {
                            "foreach": "@body('Entities_-_Get_IPs')?['IPs']",
                            "actions": {
                                "Condition_2": {
                                    "actions": {
                                        "Delay_3": {
                                            "runAfter": {},
                                            "type": "Wait",
                                            "inputs": {
                                                "interval": {
                                                    "count": 1,
                                                    "unit": "Minute"
                                                }
                                            }
                                        },
                                        "Set_variable_2": {
                                            "runAfter": {
                                                "Delay_3": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "SetVariable",
                                            "inputs": {
                                                "name": "quotaCount",
                                                "value": 0
                                            }
                                        }
                                    },
                                    "runAfter": {},
                                    "expression": {
                                        "and": [
                                            {
                                                "equals": [
                                                    "@variables('quotaCount')",
                                                    4
                                                ]
                                            }
                                        ]
                                    },
                                    "type": "If"
                                },
                                "Scope": {
                                    "actions": {
                                        "Add_comment_to_incident_(V3)_7": {
                                            "runAfter": {
                                                "Table_Results": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "ApiConnection",
                                            "inputs": {
                                                "body": {
                                                    "incidentArmId": "@triggerBody()?['object']?['id']",
                                                    "message": "<p><span style=\"font-size: 18px\"><strong>Analysis of </strong></span><span style=\"font-size: 18px\"><strong>@{items('For_each_2')?['Address']}</strong></span><span style=\"font-size: 18px\"><strong> from Virus Total</strong></span><span style=\"font-size: 24px\"><strong><br>\n</strong></span>Summary:@{body('Stats_Table')}<br>\nMain Report:@{body('Table_Results')}<br>\nAdditional Reports on this Artifact:<br>\n@{body('IP_Comments')}</p>"
                                                },
                                                "host": {
                                                    "connection": {
                                                        "name": "@parameters('$connections')['azuresentinel']['connectionId']"
                                                    }
                                                },
                                                "method": "post",
                                                "path": "/Incidents/Comment"
                                            }
                                        },
                                        "FormattedCommentReport": {
                                            "runAfter": {
                                                "FormattedIPReport": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "ParseJson",
                                            "inputs": {
                                                "content": "@body('IP_Comments')",
                                                "schema": {
                                                    "properties": {
                                                        "data": {
                                                            "items": {
                                                                "properties": {
                                                                    "attributes": {
                                                                        "properties": {
                                                                            "date": {
                                                                                "type": "integer"
                                                                            },
                                                                            "html": {
                                                                                "type": "string"
                                                                            },
                                                                            "tags": {
                                                                                "items": {
                                                                                    "type": "string"
                                                                                },
                                                                                "type": "array"
                                                                            },
                                                                            "text": {
                                                                                "type": "string"
                                                                            },
                                                                            "votes": {
                                                                                "properties": {
                                                                                    "abuse": {
                                                                                        "type": "integer"
                                                                                    },
                                                                                    "negative": {
                                                                                        "type": "integer"
                                                                                    },
                                                                                    "positive": {
                                                                                        "type": "integer"
                                                                                    }
                                                                                },
                                                                                "type": "object"
                                                                            }
                                                                        },
                                                                        "type": "object"
                                                                    },
                                                                    "id": {
                                                                        "type": "string"
                                                                    },
                                                                    "links": {
                                                                        "properties": {
                                                                            "self": {
                                                                                "type": "string"
                                                                            }
                                                                        },
                                                                        "type": "object"
                                                                    },
                                                                    "type": {
                                                                        "type": "string"
                                                                    }
                                                                },
                                                                "required": [
                                                                    "attributes",
                                                                    "type",
                                                                    "id",
                                                                    "links"
                                                                ],
                                                                "type": "object"
                                                            },
                                                            "type": "array"
                                                        },
                                                        "links": {
                                                            "properties": {
                                                                "self": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "type": "object"
                                                        },
                                                        "meta": {
                                                            "properties": {
                                                                "count": {
                                                                    "type": "integer"
                                                                }
                                                            },
                                                            "type": "object"
                                                        }
                                                    },
                                                    "type": "object"
                                                }
                                            }
                                        },
                                        "FormattedIPReport": {
                                            "runAfter": {
                                                "IP_Report_Body": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "ParseJson",
                                            "inputs": {
                                                "content": "@body('IP_Report_Body')",
                                                "schema": {
                                                    "properties": {
                                                        "data": {
                                                            "properties": {
                                                                "attributes": {
                                                                    "properties": {
                                                                        "as_owner": {
                                                                            "type": "string"
                                                                        },
                                                                        "asn": {
                                                                            "type": "integer"
                                                                        },
                                                                        "continent": {
                                                                            "type": "string"
                                                                        },
                                                                        "country": {
                                                                            "type": "string"
                                                                        },
                                                                        "jarm": {
                                                                            "type": "string"
                                                                        },
                                                                        "last_analysis_date": {
                                                                            "type": "integer"
                                                                        },
                                                                        "last_analysis_results": {
                                                                            "properties": {
                                                                                "0xSI_f33d": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "ADMINUSLabs": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "AILabs (MONITORAPP)": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Abusix": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Acronis": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "AlienVault": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "AlphaSOC": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Antiy-AVL": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "ArcSight Threat Intelligence": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "AutoShun": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Avira": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Bfore.Ai PreCrime": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "BitDefender": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Bkav": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Blueliv": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "CINS Army": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "CMC Threat Intelligence": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "CRDF": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Certego": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Chong Lua Dao": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Cluster25": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Criminal IP": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "CrowdSec": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "CyRadar": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Cyan": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Cyble": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "DNS8": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Dr.Web": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "ESET": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "ESTsecurity": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "EmergingThreats": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Emsisoft": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Ermes": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Forcepoint ThreatSeeker": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Fortinet": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "G-Data": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Google Safebrowsing": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "GreenSnow": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Heimdal Security": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "IPsum": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Juniper Networks": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "K7AntiVirus": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Kaspersky": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Lionic": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Lumu": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "MalwarePatrol": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Malwared": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Netcraft": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "OpenPhish": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "PREBYTES": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "PhishFort": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "PhishLabs": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Phishing Database": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Phishtank": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "PrecisionSec": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Quick Heal": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Quttera": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "SCUMWARE.org": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "SOCRadar": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "SafeToOpen": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Scantitan": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Seclookup": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "SecureBrain": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Segasec": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Snort IP sample list": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Sophos": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Spam404": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "StopForumSpam": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Sucuri SiteCheck": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "ThreatHive": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Threatsourcing": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Trustwave": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "URLQuery": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "URLhaus": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "VIPRE": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "VX Vault": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Viettel Threat Intelligence": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "ViriBack": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Webroot": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Xcitium Verdict Cloud": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "Yandex Safebrowsing": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "ZeroCERT": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "alphaMountain.ai": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "benkow.cc": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "desenmascara.me": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "malwares.com URL checker": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "securolytics": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "zvelo": {
                                                                                    "properties": {
                                                                                        "category": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "engine_name": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "method": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "result": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "last_analysis_stats": {
                                                                            "properties": {
                                                                                "harmless": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "malicious": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "suspicious": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "timeout": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "undetected": {
                                                                                    "type": "integer"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "last_https_certificate": {
                                                                            "properties": {
                                                                                "cert_signature": {
                                                                                    "properties": {
                                                                                        "signature": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "signature_algorithm": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "extensions": {
                                                                                    "properties": {
                                                                                        "1.3.6.1.4.1.11129.2.4.2": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "CA": {
                                                                                            "type": "boolean"
                                                                                        },
                                                                                        "authority_key_identifier": {
                                                                                            "properties": {
                                                                                                "keyid": {
                                                                                                    "type": "string"
                                                                                                }
                                                                                            },
                                                                                            "type": "object"
                                                                                        },
                                                                                        "ca_information_access": {
                                                                                            "properties": {
                                                                                                "CA Issuers": {
                                                                                                    "type": "string"
                                                                                                },
                                                                                                "OCSP": {
                                                                                                    "type": "string"
                                                                                                }
                                                                                            },
                                                                                            "type": "object"
                                                                                        },
                                                                                        "certificate_policies": {
                                                                                            "items": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "type": "array"
                                                                                        },
                                                                                        "extended_key_usage": {
                                                                                            "items": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "type": "array"
                                                                                        },
                                                                                        "key_usage": {
                                                                                            "items": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "type": "array"
                                                                                        },
                                                                                        "subject_alternative_name": {
                                                                                            "items": {
                                                                                                "type": "string"
                                                                                            },
                                                                                            "type": "array"
                                                                                        },
                                                                                        "subject_key_identifier": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "issuer": {
                                                                                    "properties": {
                                                                                        "C": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "CN": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "O": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "public_key": {
                                                                                    "properties": {
                                                                                        "algorithm": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "rsa": {
                                                                                            "properties": {
                                                                                                "exponent": {
                                                                                                    "type": "string"
                                                                                                },
                                                                                                "key_size": {
                                                                                                    "type": "integer"
                                                                                                },
                                                                                                "modulus": {
                                                                                                    "type": "string"
                                                                                                }
                                                                                            },
                                                                                            "type": "object"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "serial_number": {
                                                                                    "type": "string"
                                                                                },
                                                                                "size": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "subject": {
                                                                                    "properties": {
                                                                                        "CN": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "thumbprint": {
                                                                                    "type": "string"
                                                                                },
                                                                                "thumbprint_sha256": {
                                                                                    "type": "string"
                                                                                },
                                                                                "validity": {
                                                                                    "properties": {
                                                                                        "not_after": {
                                                                                            "type": "string"
                                                                                        },
                                                                                        "not_before": {
                                                                                            "type": "string"
                                                                                        }
                                                                                    },
                                                                                    "type": "object"
                                                                                },
                                                                                "version": {
                                                                                    "type": "string"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "last_https_certificate_date": {
                                                                            "type": "integer"
                                                                        },
                                                                        "last_modification_date": {
                                                                            "type": "integer"
                                                                        },
                                                                        "network": {
                                                                            "type": "string"
                                                                        },
                                                                        "regional_internet_registry": {
                                                                            "type": "string"
                                                                        },
                                                                        "reputation": {
                                                                            "type": "integer"
                                                                        },
                                                                        "tags": {
                                                                            "type": "array"
                                                                        },
                                                                        "total_votes": {
                                                                            "properties": {
                                                                                "harmless": {
                                                                                    "type": "integer"
                                                                                },
                                                                                "malicious": {
                                                                                    "type": "integer"
                                                                                }
                                                                            },
                                                                            "type": "object"
                                                                        },
                                                                        "whois": {
                                                                            "type": "string"
                                                                        },
                                                                        "whois_date": {
                                                                            "type": "integer"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                },
                                                                "id": {
                                                                    "type": "string"
                                                                },
                                                                "links": {
                                                                    "properties": {
                                                                        "self": {
                                                                            "type": "string"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                },
                                                                "type": {
                                                                    "type": "string"
                                                                }
                                                            },
                                                            "type": "object"
                                                        }
                                                    },
                                                    "type": "object"
                                                }
                                            }
                                        },
                                        "IP_Comments": {
                                            "runAfter": {
                                                "Increment_variable_2": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Http",
                                            "inputs": {
                                                "headers": {
                                                    "x-apikey": "@variables('VT_API_Key')"
                                                },
                                                "method": "GET",
                                                "queries": {
                                                    "limit": "10"
                                                },
                                                "uri": "https://www.virustotal.com/api/v3/ip_addresses/@{items('For_each_2')?['Address']}/comments"
                                            },
                                            "runtimeConfiguration": {
                                                "secureData": {
                                                    "properties": [
                                                        "inputs"
                                                    ]
                                                }
                                            }
                                        },
                                        "IP_Report_Body": {
                                            "runAfter": {
                                                "IP_Comments": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Http",
                                            "inputs": {
                                                "headers": {
                                                    "x-apikey": "@variables('VT_API_Key')"
                                                },
                                                "method": "GET",
                                                "uri": "https://www.virustotal.com/api/v3/ip_addresses/@{items('For_each_2')?['Address']}"
                                            },
                                            "runtimeConfiguration": {
                                                "secureData": {
                                                    "properties": [
                                                        "inputs"
                                                    ]
                                                }
                                            }
                                        },
                                        "IP_Report_Results": {
                                            "runAfter": {
                                                "FormattedCommentReport": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "AppendToArrayVariable",
                                            "inputs": {
                                                "name": "IPTableResults",
                                                "value": "@body('FormattedIPReport')?['data']?['attributes']?['last_analysis_results']"
                                            }
                                        },
                                        "IP_Stats": {
                                            "runAfter": {
                                                "IP_Report_Results": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "AppendToArrayVariable",
                                            "inputs": {
                                                "name": "IPStatsTable",
                                                "value": "@body('FormattedIPReport')?['data']?['attributes']?['last_analysis_stats']"
                                            }
                                        },
                                        "Increment_variable_2": {
                                            "runAfter": {},
                                            "type": "IncrementVariable",
                                            "inputs": {
                                                "name": "quotaCount",
                                                "value": 1
                                            }
                                        },
                                        "Stats_Table": {
                                            "runAfter": {
                                                "IP_Stats": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Table",
                                            "inputs": {
                                                "format": "HTML",
                                                "from": "@variables('IPStatsTable')"
                                            }
                                        },
                                        "Table_Results": {
                                            "runAfter": {
                                                "Stats_Table": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Table",
                                            "inputs": {
                                                "format": "HTML",
                                                "from": "@variables('IPTableResults')"
                                            }
                                        }
                                    },
                                    "runAfter": {
                                        "Condition_2": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "Scope"
                                }
                            },
                            "runAfter": {
                                "Entities_-_Get_IPs": [
                                    "Succeeded"
                                ]
                            },
                            "type": "Foreach"
                        },
                        "IP_Comments_Report": {
                            "runAfter": {
                                "IP_Summary_Table": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "IPReport",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "IP_Last_Analysis_Results": {
                            "runAfter": {
                                "IP_Comments_Report": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "IPTableResults",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "IP_Summary_Table": {
                            "runAfter": {
                                "FileHash_Last_Analysis_Report": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "IPStatsTable",
                                        "type": "array"
                                    }
                                ]
                            }
                        },
                        "Initialize_variable": {
                            "runAfter": {},
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "VT_API_Key",
                                        "type": "string"
                                    }
                                ]
                            }
                        },
                        "QuotaCounter": {
                            "runAfter": {
                                "Initialize_variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "InitializeVariable",
                            "inputs": {
                                "variables": [
                                    {
                                        "name": "quotaCount",
                                        "type": "integer",
                                        "value": 0
                                    }
                                ]
                            }
                        }
                    },
                    "outputs": {}
                },
                "parameters": {
                    "$connections": {
                        "value": {
                            "azuresentinel": {
                                "connectionId": "[variables('connections_azuresentinel_blogVirusTotalLookup_externalid')]",
                                "connectionName": "[concat('azuresentinel-', parameters('workflows_blogVirusTotalLookup_name'))]",
                                "connectionProperties": {
                                    "authentication": {
                                        "type": "ManagedServiceIdentity"
                                    }
                                },
                                "id": "[concat('/subscriptions/', parameters('subId'), '/providers/Microsoft.Web/locations/uksouth/managedApis/azuresentinel')]"
                            }
                        }
                    }
                }
            }
        }
    ]
}